## BUGS!
* We need better handling on try fail - when try is down all jobs should pause/wait for try up again. (Pending on Catlee's tree status application?)
* Incoming try syntax should be stripped of "bug XXXX" or "--post-to-bug" or "-n", since we add those anyways.
* I would like to see a handling of a "shutdown" message being sent to hgpushers which could make it possible for a graceful shutdown.
    |-> Could be sent using fanout and high priority to push it to the top of the queue?
    |-> Could also add a field for specifying an hgpusher instance (pid or hgpusher.* or... i don't know)
* Some method of clearing out patch files that we know aren't being used -- could be done at the end of pushing a job.
* Get rid of quotation marks around commit message.
* Make sure logs are rotating correctly.
* Handling failed whiteboard modifications.

* FIXED: Add tests to test_dbhandler for querying patchsets on other params than branch
* FIXED: Whenever schedulerdbpoller sends out messages that autoland doesn't track, line 381 dies on NoneType error
* FIXED: [autoland:$patchID:try_syntax] returned invalid whiteboard autoland tag (and shouldn't, should go forth with 'try' as branch) -- would like to be able to be flexible enough
to grab either or both try_syntax/patchIDs
* FIXED: multiple postings when the patchID is incorrect:
    Autoland Failure
    Specified patches [2429] do not exist, or are not posted on this bug.
    Comment published to bug 657828
    No patches listed right now, will be monitoring this bug.
* FIXED: WRITE A TEST - check 404 on attachment url: hgpusher died on trying to pull the patch (incorrectly formed url for attachments) and there was no comment inserted to db or message back to autoland_queue
* FIXED: Why does autolanduser post as Marc Jessome?? :) (answer: .hgrc)
* FIXED: Need to check for dupe patch_sets here 
* FIXED: add queue purge flag
* FIXED: Do something about the split config/auth.ini usage in hgpusher (sync the production values with puppet?)
* FIXED: NIT: autoland_queue log gets 3x the bug comment text (only one post to bug thankfully)
* FIXED: in hgpusher has_sufficient_permissions, should check the author email directly, as well as the BugzillaEmail field. (see inline XXX)
* FIXED: rename patches to user_patches where applicable.
* FIXED: get rid of log_msg usage.

## Lukas Notes
* possible bug: There's a 10 minute gap between schedulerdbpoller runs could you have an autoland push start & stop in that time with no report back?
** HgPusher could send a message to schedulerdbpoller to create the empty cache file so that it's tracked from push time

* cleanup & metrics: Set up an archiving script for postedbug.log/cache '*.done' files on cruncher - so we have history of usage and also are cleaning up periodically
** Nagios check top entry in cache files and warn about possibly hung builds
** Cronjob to clean up .done files every 24 hours that are more than 24 hours old

* informing: Documentation, blogs, tweets, Yammers, Lightning Talk, Brownbag - get the word out

* project management: tracking bug for bugs filed to this component - perhaps a bugzilla RelEng component?

* development: API implementation, multi-branch landings and map of requirements for each branch activated in this system, Bugzilla Extension for UI

* enhancement: try syntax for retrying oranges when below the threshold? Specifying the threshold?
* enhancement: builds cancelled by Self-Serve would note that in the message to the bug with final results (currently builds that end with exceptions are just 'complete' instead of interrupted)
* enhancement: Makefile & setup script for getting this system up and running in a virtualenv


## Marc Notes
0. Set up autoland-staging02 as the staging box (autoland-staging01 becomes production)
1. The use case of "Flag bug for landing --> Wait for review --> land":
    -  Will not currently work, due to an early design mistake. The fix is
       fairly straight forward, but will require some time. I can redesign
       this and implement ASAP. I've outlined the necessary changes below:
        - When a tag is found by autoland_queue.py:bz_search_handler(),
          the bug needs to be checked for reviews in the case that it is
          a to-branch landing.
        - As it stands right now, the tag is pulled and entered into the queue
          and then when popped off the queue, the reviews are checked. 
        - autoland_queue.py:get_patchset() performs checking on the reviews
          based on try/branch. get_patchset() fails out and comments on bad
          reviews. This is NOT what we want.
        - We want to check the patch in autoland_queue.py:bz_search_handler()
          for the proper review permissions, and if they are not there, we
          simply ignore it until out next poll.
        - OPTIONS:
              o  change autoland_queue.py:get_patchset() to have a toggle on
                 comment posting, and use the get_patchset function to check.
              o  rewrite autoland_queue.py:get_patchset() to return a
                 pass/fail state, for example:
                    return (False, 'Autoland Failure Comment')
                 and only post the comment in the correct cases.
              o  I'm sure there are better ideas out there
        - NOTE: Check patch headers at this point, so users aren't waiting
                a while just for a failure.
2. Some improvements I would like to make are:
    - Get tests using a static test config, rather than the default config
      file.
    - After landing on branch, should set attachment flag checked-in+ (if it's possible to do a whiteboard tag, comment, checkin flag as one transaction that would be great)
3. autoland_queue needs to poll the database for jobs that have been in the queue for a long time (waiting for tests to be written)
4. Handle clone failures properly. (see Code review question)

## Dear Future Autolanding
0. HgExtension (using Pbiggar's trychooser one) - could take your patches(diff) and create bugzilla 
   attachemnt with bz API, put in the right autoland comments and Bob's your uncle: you just did it
   all from the command line
1. Metrics (runtime, etc)
